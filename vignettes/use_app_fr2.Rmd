---
title: "Utilisation de l’application"
output: 
  bookdown::html_document2:
      base_format: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Utilisation de l’application}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
bibliography: references.bib
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  echo = FALSE,
  message = FALSE, 
  warning = FALSE,
  comment = "#>"
)
```

```{r setup}
library(CaribouDemographyBasicApp)
lang <- "fr2"
```

```{=html}
<!---
A vignette to outline the uses of the app including: General description of the interface Uncertainty
How to update data
Technical write up on how models are fit that refers back to bboutools/caribouMetrics --->
```

# Utilisation de l’application

L’application **Explorateur de changements des populations de caribou boréal** vous aide à explorer ce qui pourrait arriver aux populations de caribou boréal au fil du temps. Elle montre les tendances futures possibles – si le nombre de caribous pourrait augmenter, diminuer ou rester à peu près le même – en fonction des informations dont nous disposons actuellement. Entre autres, cette application vous permet de voir combien de caribous survivent chaque année et combien de faons (bébés caribou) naissent et survivent jusqu’à l’inventaire d’hiver. Noter : cette application est encore au stade de prototype et sera amélioré dans les mois à venir. 

L’application utilise des méthodes provenant des packages R « bboutools » et « caribouMetrics ». Ces méthodes reposent sur des données issues de relevés sur le terrain. Les femelles caribous sont équipées de colliers GPS pour suivre leur survie. Le recrutement est mesuré en comptant les faons pour 100 femelles environ neuf mois après la mise bas. Ces informations sont combinées pour estimer l’évolution de la population dans le temps. 


## Utilisation typique de l’application
La plupart des utilisateurs ouvriront l’application avec des données sur les populations de caribous déjà incluses. 

L’onglet **Accueil** explique en quoi consiste l’application et quel en est son fonctionnement. Vous pouvez choisir votre langue (français ou anglais ainsi qu’une version en langage clair (simple)) et définir les options utilisées dans l’onglet Résultat.

L’onglet **Données d’inventaire** présente les informations utilisées pour estimer la survie des femelles et le recrutement des faons. Il comprend cinq sections :

-  Une **Description des données** où l’on retrouve une carte des populations de caribou ainsi que la liste des rapports d’inventaires d’où proviennent les données. Vous pouvez agrandir cette section en plein écran pour faciliter la lecture en cliquant sur le bouton d’agrandissement en bas à droite de la fenêtre.
-  Un **Avis de non-responsabilité** des créateurs de l’application. 
-  Le **Résumé des données d’inventaires** avec des graphiques montrant combien de caribous ont été équipés de colliers et de ceux-ci combien sont morts, ainsi que le nombre de caribous comptés lors de l’inventaire d’hiver chaque année.  Ces chiffres ne doivent pas être comparés directement d’une année à l’autre parce que la zone de l’inventaire (à l’intérieur d’une population) n’est pas la même. Ces valeurs sont utilisées par le modèle pour estimer les ratios de mâles par rapport aux femelles et de femelles par rapport aux faons dans la population. (utilisé pour le calcul du recrutement).  
    Vous pouvez alterner entre les graphiques de survie et de recrutement en cliquant sur le bouton en haut à droite de la section.

-  Les **Estimés du modèle** montrant la survie des femelles et le recrutement des faons estimés pour chaque année. Le recrutement est mesuré en terme du ratio du nombre de faons pour 100 femelles. Dans ces graphiques, chaque point représente la valeur moyenne, et les lignes qui en partent indiquent la plage des valeurs possibles.
-  Le tableau **Résumé des données** indiquant la taille de la population initiale de femelles utilisée pour créer les scénarios possibles, l’année où cette taille a été enregistrée, et le nombre d’années de données disponibles pour la survie et le recrutement.

Si une seule année de données de survie ou de recrutement est disponible, aucun résultat ne sera affiché parce qu’une seule année ne fournit pas assez d'informations pour qu’une prévision soit fiable.

```{r out.width=600}
# knitr::include_graphics(here::here("inst", "www", "survivalSummary.png" ))
# knitr::include_graphics(here::here("inst", "www", "recruitmentSummary.png" ))
knitr::include_graphics(here::here("vignettes/snapshots", paste0("input_data_", lang, ".png" )))
```

L’Onglet **Résultats**

Cet onglet montre comment la population pourrait évoluer dans le temps en fonction des données disponibles. Dans la barre latérale, vous pouvez sélectionner une population et le nombre d’années de modélisation, puis cliquer sur « Exécuter le modèle ». 

Le graphique principal montre le nombre prédit de femelles adultes au fil du temps. La ligne épaisse représente la prédiction moyenne, sans tenir compte de l’incertitude des données. Les lignes plus fines montrent d’autres résultats possibles en raison de cette incertitude. 

Seule la population femelle est affichée, car on suppose que le nombre de femelles limite la croissance de la population. Une population est stable ou en augmentation si la ligne est plate ou ascendante, et en déclin si elle descend. L’ajout de données supplémentaires réduit l’incertitude du modèle. 

Remarque : toutes les sources d’incertitude concernant l’avenir ne sont pas incluses dans ce modèle. Les changements futurs du paysage et du climat auront un impact sur les caribous, mais ces changements ne sont pas pris en compte. Ce modèle simple illustre des futurs possibles si les conditions restent les mêmes pour les caribous.

Un tableau sous le graphique indique les taux estimés du modèle (recrutement des faons, la survie des femelles) et le temps nécessaire pour que la population tombe sous la barre des 10 femelles. Cela correspond au seuil de quasi-extinction : un point où la population est peu susceptible de se rétablir (selon @eccc2011).

```{r out.width=600}
# knitr::include_graphics(here::here("inst", "www", "survivalSummary.png" ))
# knitr::include_graphics(here::here("inst", "www", "recruitmentSummary.png" ))
knitr::include_graphics(here::here("vignettes/snapshots", paste0("full_results_", lang, ".png" )))
```

Un graphique à barres sous le tableau montre le pourcentage de mortalité des femelles et le taux de remplacement des femelles (nombre de nouveaux faons femelles rejoignant la population). Les barres colorées indiquent la valeur moyenne, et les lignes montrent la plage des valeurs possibles compte tenu de l’incertitude des données. 

Une population est en croissance ou reste stable lorsque le taux de remplacement des femelles est égal ou supérieur à la mortalité des femelles. Par exemple, si la population initiale de femelles était de 100 individus et que le taux de survie était de 74%, cela voudrait dire que 74 femelles auraient survécu au début de l’année (à l’inventaire d’hiver) et que 26 seraient mortes. Si le taux de recrutement était de 24%, cela signifierait qu’il y avait en moyenne 24 faons pour 100 femelles. Comme la moitié de ces faons serait des femelles, il n’y aurait eu que 12 femelles faons qui se seraient jointes à la population, ce qui ne serait pas suffisant pour remplacer les 26 femelles mortes. C’est pour cela qu’il y a un déclin. Selon ces mêmes taux, s’il y avait 500 femelles au départ, 370 auraient survécu, 130 seraient mortes, et seulement 60 femelles faons se seraient rajoutés à la population. Ces chiffres ne sont pas suffisants pour stabiliser ou augmenter la taille de la population. 

Ce qui est formidable avec cette application, c'est qu'elle vous permet d’explorer des scénarios « hypothétiques » pour voir comment le changement des taux de survie des femelles et/ou de recrutement des faons pourrait influencer la croissance ou le déclin des populations. Cliquez sur « Ajouter un scénario alternatif » et saisissez un nom descriptif pour le scénario. Par exemple, si vous voulez augmenter la survie des femelles à 85% et laisser le recrutement à 24%, vous pouvez écrire : 85% Fem 24 % Faons. Cette façon simple de nommer les scénarios vous permettra de mieux les comparer par la suite. Déplacez le curseur de survie de 74% à 85% et laisser celui du recrutement à 24%, puis cliquez sur « Exécuter le modèle ». L’application ajoutera les résultats mis à jour aux graphiques et tableaux, en les affichant dans une couleur différente de celle du scénario original. Vous pouvez créer plusieurs autres scénarios avec des taux de survie des femelles et de recrutement des faons différents jusqu’à ce que vous trouviez des valeurs qui font en sorte que la population se stabilise ou bien augmente. Par exemple, essayez un taux de survie de 85% et un taux de recrutement de 35% et un autre avec un taux de survie de 90% et de recrutement de 24% ou de 35% et voyez comment se modifie la courbe. 

Ainsi, vous pourrez déterminer quelles combinaisons de taux de survie et de recrutement seraient nécessaires pour stabiliser ou augmenter la population. 


```{r out.width=600}
knitr::include_graphics(here::here("vignettes/snapshots", paste0("alt_results_", lang, ".png" )))
```

Dans cet exemple, une façon de stabiliser la population consiste à augmenter la survie des femelles. Elle doit être d’au moins 85% pour stabiliser la population mais de 90% pour qu’elle augmente. En augmentant la survie des femelles à 90% et le recrutement des faons à 35%, on diminue ainsi la mortalité des femelles et on augmente le taux de remplacement des femelles (par les faons femelles) suffisamment pour que la population puisse augmenter et permettre à terme un retour progressif à la viabilité.

Vous pourriez ensuite discuter avec les gens pour déterminer si ces chiffres sont réalistes et ce que votre communauté pourrait faire pour aider, par exemple des fermetures de chemins, le contrôle de prédateurs ou de ne plus prélever de femelles.

Cet onglet inclut également un glossaire et des questions fréquemment posées.

## Comment téléverser ou mettre à jour les données

Tout d’abord il faut installer l’application. Il existe deux façons de le faire :

1.	Télécharger une version de l’application qui inclut tous les logiciels nécessaires pour l’exécuter ainsi que les données sur le caribou (voir la [page des versions](https://github.com/LandSciTech/CaribouDemographyBasicApp/releases)), ou
2.	Installer le package R dans votre propre version de R via la console R (voir les [instructions d’installation](https://github.com/LandSciTech/CaribouDemographyBasicApp?tab=readme-ov-file#installation) pour plus de détails). 

Seuls les utilisateurs qui ont installé le package R via la console R, plutôt qu’en utilisant la version de l’application qui inclut tous les logiciels nécessaires, peuvent modifier les données incluses dans l’application.

L’application utilise des données de survie et de recrutement du caribou sauvegardées dans une feuille Google pour calculer les taux démographiques. Cela permet à plusieurs utilisateurs de collaborer à la modification des données. Ces données sont téléchargées et utilisées pour ajuster les modèles bayésiens de survie et de recrutement, et les résultats sont stockés dans le package R afin que les modèles n’aient pas besoin d’être réajustés à chaque utilisation de l’application.


**Pour modifier les données utilisées dans l’application, suivez ces étapes :**

1.  **Créez une feuille de calcul Google pour vos données d’inventaire.** La feuille doit respecter le format utilisé par [bboutools](https://poissonconsulting.github.io/bboutools/articles/bboutools.html#providing-data). Vous pouvez copier ce modèle de feuille Google [template Google Sheet]( https://docs.google.com/spreadsheets/d/1i53nQrJXgrq3B6jO0ATHhSIbibtLq5TmmFL-PxGQNm8/edit?usp=sharing )  et le remplir avec vos propres données. Par la suite, la sauvegarder (« Make a copy ») sur un Google drive.  
    En ce qui concerne l'onglet « recruit_data », si vous n'avez pas de dates spécifiques à déclarer, vous pouvez définir n'importe quelle date arbitraire avant le 1er avril. Les onglets « recruit_data » et « surv_data » sont utilisés par bboutools pour estimer les taux de survie et de recrutement. Pour projeter l'évolution de la taille de la population au fil du temps, ces taux sont combinés à une estimation de la taille initiale de la population de femelles fournie dans l'onglet « population_estimates ».  
    Pour chaque population, indiquez une borne inférieure et supérieure de l’estimation. Si plusieurs années d’estimations sont fournies, seule la plus récente sera utilisée.  
    L’onglet « data_description » permet de décrire les données des autres feuilles dans plusieurs langues. Vous pouvez formater le texte avec le langage Markdown (voir le (Guide de Syntaxe Markdown | Doc Projet) pour un aide-mémoire).

2.	**Partagez votre feuille Google pour qu’elle soit accessible dans l’application.** Cliquez sur le bouton « Share » (Partager) en haut à droite de la feuille. Donnez ensuite l’accès aux adresses courriel souhaitées ou définissez l’accès à «“Anyone with the link” can view the Sheet (Toute personne disposant du lien peut consulter la feuille). Copiez le lien pour le partager.
3.	Dans l’application, **cliquez sur le bouton « Mettre à jour les données », collez votre lien dans la zone de texte URL, puis cliquez sur « Mettre à jour ».**
4.	Si nécessaire, suivez les instructions pour autoriser l’application à accéder à votre compte Google Drive. Pour éviter cela, vous pouvez modifier les paramètres de la feuille Google pour permettre à « Toute personne disposant du lien » de la consulter.
5.	**Patientez pendant le réajustement du modèle, cela peut prendre environ 5 minutes.**
6.	L’application mettra automatiquement à jour les taux démographiques et les projections en fonction des nouvelles données.

## Détails techniques de l’ajustement du modèle {#technical-details}

L’application utilise le package [bboutools](https://poissonconsulting.github.io/bboutools/articles/bboutools.html) pour estimer les taux de survie et de recrutement à partir des données démographiques sur les caribous [@dalgarno2025]. 

bboutools ajuste des modèles bayésiens de recrutement et de survie annuels en utilisant des modèles linéaires mixtes généralisés où l’année est considérée comme un effet aléatoire si les données couvrent plus de 5 ans. 

Les paramètres nécessaires pour informer les projections démographiques sont extraits de ces modèles. Ils incluent la moyenne, l’écart-type, l’intervalle de crédibilité à 95 %, ainsi que la variation interannuelle. Il est nécessaire d’extraire ces paramètres plutôt que d’utiliser directement le modèle afin de pouvoir les modifier pour refléter des scénarios alternatifs. Ces modèles bayésien ne sont réestimés que lorsque les données sont mises à jour.  

Les taux démographiques pour la population et leur variation attendue sont ensuite utilisés pour alimenter l’application pour le scénario « Actuel » et projeter la population femelle sur 20 ans.
La croissance projetée est déterminée pour 35 trajectoires exemples avec des taux démographiques échantillonnés à partir du modèle bayésien résumé. Ensuite, [`caribouMetrics::caribouPopGrowth()`](https://landscitech.github.io/caribouMetrics/reference/caribouPopGrowth.html)) est utilisé pour exécuter un modèle démographique qui projette la croissance sur 20 ans.

Le modèle démographique est réexécuté chaque fois que « Exécuter le modèle » est cliqué, ce qui peut légèrement modifier les graphiques puisque certaines parties du modèle incluent des valeurs aléatoires. Si un scénario alternatif est ajouté, le même modèle est exécuté avec les taux fournis pour projeter la population dans ce scénario.


# Références

